{
  "id": "insuranceclaims",
  "title": "Insurance Claims",
  "description": "Manages insurance claim submissions, approvals, and settlements for patient bills and invoices.",
  "route": "/billing/insuranceclaims",
  "icon": "ShieldCheck",
  "entity": "InsuranceClaim",
  "version": "1.0.0",

  "permissions": {
    "view": ["Admin", "Accountant", "BillingStaff"],
    "create": ["Accountant", "BillingStaff"],
    "edit": ["Admin", "Accountant"],
    "delete": ["Admin"]
  },

  "api": {
    "list": "/api/insuranceclaims",
    "get": "/api/insuranceclaims/:id",
    "create": "/api/insuranceclaims",
    "update": "/api/insuranceclaims/:id",
    "delete": "/api/insuranceclaims/:id"
  },

  "fields": [
    {
      "name": "id",
      "label": "Claim ID",
      "type": "uuid",
      "primary": true,
      "autoGenerated": true
    },
    {
      "name": "claimNumber",
      "label": "Claim Number",
      "type": "string",
      "required": true,
      "unique": true,
      "showInList": true
    },
    {
      "name": "invoiceId",
      "label": "Invoice Reference",
      "type": "relation",
      "relationEntity": "invoices",
      "relationField": "invoiceNumber",
      "required": true,
      "showInList": true
    },
    {
      "name": "patientId",
      "label": "Patient",
      "type": "relation",
      "relationEntity": "patients",
      "relationField": "fullName",
      "required": true,
      "showInList": true
    },
    {
      "name": "insuranceProvider",
      "label": "Insurance Provider",
      "type": "string",
      "placeholder": "e.g., Star Health, ICICI Lombard",
      "required": true,
      "showInList": true
    },
    {
      "name": "policyNumber",
      "label": "Policy Number",
      "type": "string",
      "required": true,
      "showInList": true
    },
    {
      "name": "claimAmount",
      "label": "Claim Amount",
      "type": "currency",
      "required": true,
      "showInList": true
    },
    {
      "name": "approvedAmount",
      "label": "Approved Amount",
      "type": "currency",
      "default": 0,
      "showInList": true
    },
    {
      "name": "submissionDate",
      "label": "Submission Date",
      "type": "date",
      "required": true,
      "showInList": true
    },
    {
      "name": "approvalDate",
      "label": "Approval Date",
      "type": "date",
      "showInList": true
    },
    {
      "name": "status",
      "label": "Claim Status",
      "type": "enum",
      "options": ["SUBMITTED", "UNDER_REVIEW", "APPROVED", "REJECTED", "SETTLED"],
      "default": "SUBMITTED",
      "widget": "badge",
      "showInList": true
    },
    {
      "name": "remarks",
      "label": "Remarks / Notes",
      "type": "text",
      "placeholder": "Add remarks from insurer or billing staff",
      "showInList": false
    },
    {
      "name": "documents",
      "label": "Attached Documents",
      "type": "file",
      "multiple": true,
      "showInList": false
    },
    {
      "name": "processedBy",
      "label": "Processed By",
      "type": "relation",
      "relationEntity": "users",
      "relationField": "email",
      "showInList": true
    },
    {
      "name": "createdAt",
      "label": "Created At",
      "type": "datetime",
      "readOnly": true,
      "showInList": true
    },
    {
      "name": "updatedAt",
      "label": "Updated At",
      "type": "datetime",
      "readOnly": true
    }
  ],

  "relations": [
    {
      "entity": "invoices",
      "type": "ManyToOne",
      "foreignKey": "invoiceId"
    },
    {
      "entity": "patients",
      "type": "ManyToOne",
      "foreignKey": "patientId"
    },
    {
      "entity": "users",
      "type": "ManyToOne",
      "foreignKey": "processedBy"
    }
  ],

  "ui": {
    "listView": {
      "title": "Insurance Claims",
      "columns": ["claimNumber", "patientId", "insuranceProvider", "claimAmount", "status", "submissionDate"],
      "filters": ["insuranceProvider", "status"],
      "searchFields": ["claimNumber", "policyNumber", "insuranceProvider"],
      "actions": ["view", "edit", "delete"]
    },
    "formView": {
      "title": "New Insurance Claim",
      "layout": [
        ["claimNumber", "invoiceId"],
        ["patientId", "insuranceProvider"],
        ["policyNumber", "claimAmount"],
        ["approvedAmount"],
        ["submissionDate", "approvalDate"],
        ["status"],
        ["remarks"],
        ["documents"]
      ],
      "actions": ["save", "cancel"]
    },
    "detailView": {
      "title": "Insurance Claim Details",
      "sections": [
        {
          "title": "Claim Info",
          "fields": ["claimNumber", "policyNumber", "insuranceProvider", "claimAmount", "approvedAmount", "status"]
        },
        {
          "title": "Linked Entities",
          "fields": ["invoiceId", "patientId", "processedBy"]
        },
        {
          "title": "Documents & Notes",
          "fields": ["documents", "remarks"]
        }
      ]
    }
  },

  "actions": [
    {
      "id": "approveClaim",
      "label": "Approve Claim",
      "type": "update",
      "endpoint": "/api/insuranceclaims/:id/status",
      "method": "PUT",
      "payload": { "status": "APPROVED" },
      "successMessage": "Insurance claim approved successfully!"
    },
    {
      "id": "rejectClaim",
      "label": "Reject Claim",
      "type": "update",
      "endpoint": "/api/insuranceclaims/:id/status",
      "method": "PUT",
      "payload": { "status": "REJECTED" },
      "successMessage": "Insurance claim rejected."
    },
    {
      "id": "markSettled",
      "label": "Mark as Settled",
      "type": "update",
      "endpoint": "/api/insuranceclaims/:id/status",
      "method": "PUT",
      "payload": { "status": "SETTLED" },
      "successMessage": "Insurance claim marked as settled."
    }
  ],

  "reasoning": {
    "businessLogic": "Insurance claims help recover billed amounts from insurance providers. Each claim links to a patient invoice and tracks approval stages with supporting documentation for audit purposes.",
    "uiLogic": "Billing staff can create and track claims visually by status badges. Uploaded PDFs and receipts ensure all claim documents are centralized for verification and external submission."
  }
}
