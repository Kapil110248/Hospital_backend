{
  "id": "labtesttemplates",
  "title": "Lab Test Templates",
  "description": "Stores predefined templates for laboratory tests, including reference ranges, measurement units, and test categories.",
  "route": "/lab/test-templates",
  "icon": "FlaskConical",
  "entity": "LabTestTemplate",
  "version": "1.0.0",

  "permissions": {
    "view": ["Admin", "LabTechnician", "Doctor"],
    "create": ["Admin", "LabTechnician"],
    "edit": ["Admin", "LabTechnician"],
    "delete": ["Admin"]
  },

  "api": {
    "list": "/api/labtesttemplates",
    "get": "/api/labtesttemplates/:id",
    "create": "/api/labtesttemplates",
    "update": "/api/labtesttemplates/:id",
    "delete": "/api/labtesttemplates/:id"
  },

  "fields": [
    {
      "name": "id",
      "label": "Template ID",
      "type": "uuid",
      "primary": true,
      "autoGenerated": true
    },
    {
      "name": "testName",
      "label": "Test Name",
      "type": "string",
      "placeholder": "e.g., Complete Blood Count (CBC)",
      "required": true,
      "unique": true,
      "showInList": true
    },
    {
      "name": "category",
      "label": "Category",
      "type": "enum",
      "options": ["HEMATOLOGY", "BIOCHEMISTRY", "MICROBIOLOGY", "IMMUNOLOGY", "URINALYSIS", "PATHOLOGY", "OTHER"],
      "widget": "select",
      "required": true,
      "showInList": true
    },
    {
      "name": "parameterList",
      "label": "Parameters",
      "type": "array",
      "items": {
        "type": "object",
        "fields": [
          { "name": "parameterName", "type": "string", "label": "Parameter", "required": true },
          { "name": "unit", "type": "string", "label": "Unit", "placeholder": "mg/dL, g/L, etc." },
          { "name": "normalRange", "type": "string", "label": "Normal Range", "placeholder": "4.0 - 5.5" },
          { "name": "isCritical", "type": "boolean", "label": "Critical Parameter", "default": false }
        ]
      },
      "widget": "table",
      "showInList": false
    },
    {
      "name": "sampleType",
      "label": "Sample Type",
      "type": "enum",
      "options": ["BLOOD", "URINE", "SALIVA", "STOOL", "TISSUE", "OTHER"],
      "widget": "select",
      "required": true,
      "showInList": true
    },
    {
      "name": "method",
      "label": "Test Method",
      "type": "string",
      "placeholder": "e.g., ELISA, Spectrophotometry, Manual",
      "showInList": true
    },
    {
      "name": "estimatedTime",
      "label": "Estimated Time (hrs)",
      "type": "number",
      "default": 1,
      "showInList": true
    },
    {
      "name": "cost",
      "label": "Standard Cost",
      "type": "currency",
      "required": true,
      "showInList": true
    },
    {
      "name": "active",
      "label": "Active Status",
      "type": "boolean",
      "default": true,
      "widget": "toggle",
      "showInList": true
    },
    {
      "name": "createdBy",
      "label": "Created By",
      "type": "relation",
      "relationEntity": "users",
      "relationField": "email",
      "showInList": true
    },
    {
      "name": "createdAt",
      "label": "Created At",
      "type": "datetime",
      "readOnly": true,
      "showInList": true
    },
    {
      "name": "updatedAt",
      "label": "Updated At",
      "type": "datetime",
      "readOnly": true
    }
  ],

  "relations": [
    {
      "entity": "users",
      "type": "ManyToOne",
      "foreignKey": "createdBy"
    }
  ],

  "ui": {
    "listView": {
      "title": "Lab Test Templates",
      "columns": ["testName", "category", "sampleType", "cost", "active", "createdAt"],
      "filters": ["category", "sampleType", "active"],
      "searchFields": ["testName", "category"],
      "actions": ["view", "edit", "delete"]
    },
    "formView": {
      "title": "Add / Edit Lab Test Template",
      "layout": [
        ["testName", "category"],
        ["sampleType", "method"],
        ["estimatedTime", "cost"],
        ["parameterList"],
        ["active"]
      ],
      "actions": ["save", "cancel"]
    },
    "detailView": {
      "title": "Test Template Details",
      "sections": [
        {
          "title": "General Info",
          "fields": ["testName", "category", "sampleType", "method", "estimatedTime", "cost"]
        },
        {
          "title": "Parameters",
          "fields": ["parameterList"]
        },
        {
          "title": "Metadata",
          "fields": ["createdBy", "createdAt", "updatedAt"]
        }
      ]
    }
  },

  "actions": [
    {
      "id": "duplicateTemplate",
      "label": "Duplicate Template",
      "type": "custom",
      "endpoint": "/api/labtesttemplates/:id/duplicate",
      "method": "POST",
      "successMessage": "Template duplicated successfully!"
    },
    {
      "id": "deactivateTemplate",
      "label": "Deactivate Template",
      "type": "update",
      "endpoint": "/api/labtesttemplates/:id/status",
      "method": "PUT",
      "payload": { "active": false },
      "successMessage": "Template deactivated."
    }
  ],

  "reasoning": {
    "businessLogic": "Lab test templates create standardization across all diagnostic services. It helps lab staff quickly generate test reports with preloaded parameters and ranges.",
    "uiLogic": "UI uses a tabular form for parameter entry, making it simple for lab managers to edit units, normal ranges, and mark critical tests. Active status controls availability during test request creation."
  }
}
