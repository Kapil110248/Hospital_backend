{
  "id": "patients",
  "title": "Patients",
  "description": "Registry for hospital patients including demographics, contact details, medical history, insurance, and linked visits.",
  "route": "/patients",
  "icon": "UserCircle",
  "entity": "Patient",
  "version": "1.0.0",

  "permissions": {
    "view": ["Admin", "Receptionist", "Doctor", "Nurse"],
    "create": ["Admin", "Receptionist"],
    "edit": ["Admin", "Receptionist"],
    "delete": ["Admin"]
  },

  "api": {
    "list": "/api/patients",
    "get": "/api/patients/:id",
    "create": "/api/patients",
    "update": "/api/patients/:id",
    "delete": "/api/patients/:id"
  },

  "fields": [
    {
      "name": "id",
      "label": "Patient ID",
      "type": "uuid",
      "primary": true,
      "autoGenerated": true,
      "showInList": false
    },
    {
      "name": "patientCode",
      "label": "Patient Code",
      "type": "string",
      "required": true,
      "unique": true,
      "placeholder": "PAT-001",
      "showInList": true,
      "sortable": true
    },
    {
      "name": "firstName",
      "label": "First Name",
      "type": "string",
      "required": true,
      "placeholder": "Enter first name",
      "validation": { "pattern": "^[A-Za-z]+$" },
      "showInList": true
    },
    {
      "name": "lastName",
      "label": "Last Name",
      "type": "string",
      "placeholder": "Enter last name",
      "showInList": true
    },
    {
      "name": "gender",
      "label": "Gender",
      "type": "enum",
      "options": ["MALE", "FEMALE", "OTHER"],
      "widget": "select",
      "required": true,
      "showInList": true,
      "filterable": true
    },
    {
      "name": "dateOfBirth",
      "label": "Date of Birth",
      "type": "date",
      "required": true,
      "showInList": true
    },
    {
      "name": "age",
      "label": "Age",
      "type": "computed",
      "formula": "calculateAge(dateOfBirth)",
      "readOnly": true,
      "showInList": true
    },
    {
      "name": "bloodGroup",
      "label": "Blood Group",
      "type": "enum",
      "options": ["A+", "A-", "B+", "B-", "AB+", "AB-", "O+", "O-"],
      "widget": "select",
      "showInList": true
    },
    {
      "name": "contactNumber",
      "label": "Contact Number",
      "type": "string",
      "validation": { "pattern": "^[0-9]{10,15}$" },
      "placeholder": "+91 9876543210",
      "showInList": true
    },
    {
      "name": "email",
      "label": "Email",
      "type": "email",
      "placeholder": "example@email.com",
      "showInList": true
    },
    {
      "name": "address",
      "label": "Address",
      "type": "string",
      "widget": "textarea",
      "placeholder": "Enter residential address"
    },
    {
      "name": "emergencyContactName",
      "label": "Emergency Contact Name",
      "type": "string"
    },
    {
      "name": "emergencyContactNumber",
      "label": "Emergency Contact Number",
      "type": "string",
      "validation": { "pattern": "^[0-9]{10,15}$" }
    },
    {
      "name": "insuranceProvider",
      "label": "Insurance Provider",
      "type": "string",
      "placeholder": "ABC Health Insurance Ltd."
    },
    {
      "name": "insurancePolicyNumber",
      "label": "Insurance Policy No.",
      "type": "string",
      "placeholder": "INS-1234567"
    },
    {
      "name": "admissionStatus",
      "label": "Admission Status",
      "type": "enum",
      "options": ["OUTPATIENT", "INPATIENT", "DISCHARGED"],
      "widget": "select",
      "default": "OUTPATIENT",
      "showInList": true,
      "filterable": true
    },
    {
      "name": "admissionDate",
      "label": "Admission Date",
      "type": "datetime"
    },
    {
      "name": "dischargeDate",
      "label": "Discharge Date",
      "type": "datetime"
    },
    {
      "name": "referredById",
      "label": "Referred By (Doctor)",
      "type": "relation",
      "relationEntity": "doctors",
      "relationField": "doctorCode",
      "widget": "select",
      "showInList": true
    },
    {
      "name": "isActive",
      "label": "Active",
      "type": "boolean",
      "default": true,
      "widget": "toggle",
      "showInList": true,
      "filterable": true
    },
    {
      "name": "createdAt",
      "label": "Created At",
      "type": "datetime",
      "readOnly": true,
      "showInList": true,
      "sortable": true
    },
    {
      "name": "updatedAt",
      "label": "Updated At",
      "type": "datetime",
      "readOnly": true
    }
  ],

  "relations": [
    { "entity": "doctors", "type": "ManyToOne", "foreignKey": "referredById" },
    { "entity": "appointments", "type": "OneToMany", "foreignKey": "patientId" },
    { "entity": "vitals", "type": "OneToMany", "foreignKey": "patientId" },
    { "entity": "medicalrecords", "type": "OneToMany", "foreignKey": "patientId" },
    { "entity": "followups", "type": "OneToMany", "foreignKey": "patientId" }
  ],

  "ui": {
    "listView": {
      "title": "Patients Directory",
      "columns": ["patientCode", "firstName", "lastName", "gender", "age", "bloodGroup", "admissionStatus", "isActive"],
      "searchFields": ["patientCode", "firstName", "lastName", "contactNumber", "email"],
      "filters": ["gender", "bloodGroup", "admissionStatus", "isActive"],
      "actions": ["view", "edit", "delete"]
    },
    "formView": {
      "title": "Add / Edit Patient",
      "layout": [
        ["patientCode", "firstName", "lastName"],
        ["gender", "dateOfBirth", "bloodGroup"],
        ["contactNumber", "email"],
        ["address"],
        ["emergencyContactName", "emergencyContactNumber"],
        ["insuranceProvider", "insurancePolicyNumber"],
        ["referredById", "admissionStatus"],
        ["admissionDate", "dischargeDate"],
        ["isActive"]
      ],
      "actions": ["save", "reset", "cancel"]
    },
    "detailView": {
      "title": "Patient Profile",
      "sections": [
        {
          "title": "Personal Information",
          "fields": ["patientCode", "firstName", "lastName", "gender", "dateOfBirth", "age", "bloodGroup"]
        },
        {
          "title": "Contact & Address",
          "fields": ["contactNumber", "email", "address", "emergencyContactName", "emergencyContactNumber"]
        },
        {
          "title": "Insurance & Admission",
          "fields": ["insuranceProvider", "insurancePolicyNumber", "admissionStatus", "admissionDate", "dischargeDate"]
        },
        {
          "title": "Doctor & Linked Records",
          "fields": ["referredById"]
        }
      ]
    }
  },

  "actions": [
    {
      "id": "addPatient",
      "label": "Add Patient",
      "type": "create",
      "endpoint": "/api/patients",
      "method": "POST",
      "successMessage": "Patient added successfully"
    },
    {
      "id": "updatePatient",
      "label": "Update Patient",
      "type": "edit",
      "endpoint": "/api/patients/:id",
      "method": "PUT",
      "successMessage": "Patient details updated"
    },
    {
      "id": "toggleStatus",
      "label": "Activate / Deactivate",
      "type": "toggle",
      "endpoint": "/api/patients/:id/status",
      "method": "PATCH",
      "successMessage": "Patient status updated"
    },
    {
      "id": "dischargePatient",
      "label": "Mark as Discharged",
      "type": "action",
      "endpoint": "/api/patients/:id/discharge",
      "method": "POST",
      "confirmation": "Mark this patient as discharged?",
      "successMessage": "Patient marked as discharged successfully"
    }
  ],

  "reasoning": {
    "businessLogic": "The Patients registry is the foundation of the hospital management system. Each patient is linked with appointments, vitals, medical records, and follow-ups. Admission status determines bed occupancy and billing workflows.",
    "uiLogic": "Admins and receptionists can create and edit patient records, while doctors and nurses have read-only access. The patient profile integrates with vitals, medical history, and follow-up tracking via tabs or submodules."
  }
}
