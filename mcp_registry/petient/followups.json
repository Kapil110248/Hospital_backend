{
  "id": "followups",
  "title": "Patient Follow-ups",
  "description": "Tracks scheduled and completed patient follow-up visits for monitoring ongoing treatments and post-discharge reviews.",
  "route": "/patients/followups",
  "icon": "CalendarClock",
  "entity": "FollowUp",
  "version": "1.0.0",

  "permissions": {
    "view": ["Admin", "Doctor", "Receptionist"],
    "create": ["Doctor", "Receptionist"],
    "edit": ["Doctor", "Admin"],
    "delete": ["Admin"]
  },

  "api": {
    "list": "/api/followups",
    "get": "/api/followups/:id",
    "create": "/api/followups",
    "update": "/api/followups/:id",
    "delete": "/api/followups/:id",
    "byPatient": "/api/followups/patient/:patientId"
  },

  "fields": [
    { "name": "id", "label": "Follow-up ID", "type": "uuid", "autoGenerated": true, "primary": true },
    { "name": "patientId", "label": "Patient", "type": "relation", "relationEntity": "patients", "relationField": "fullName", "required": true, "showInList": true },
    { "name": "appointmentId", "label": "Related Appointment", "type": "relation", "relationEntity": "appointments", "relationField": "appointmentCode", "showInList": false },
    { "name": "doctorId", "label": "Assigned Doctor", "type": "relation", "relationEntity": "doctors", "relationField": "fullName", "required": true, "showInList": true },
    { "name": "followUpDate", "label": "Follow-up Date", "type": "date", "required": true, "showInList": true },
    { "name": "purpose", "label": "Purpose", "type": "enum", "options": ["REVIEW", "LAB_RESULT", "PROCEDURE", "FOLLOW_CHECKUP"], "widget": "select", "showInList": true },
    { "name": "notes", "label": "Notes", "type": "textarea", "placeholder": "Enter details about the follow-up purpose" },
    { "name": "feedback", "label": "Patient Feedback", "type": "textarea", "placeholder": "Optional feedback after follow-up" },
    { "name": "status", "label": "Status", "type": "enum", "options": ["SCHEDULED", "COMPLETED", "MISSED", "CANCELLED"], "default": "SCHEDULED", "widget": "badge", "showInList": true },
    { "name": "createdAt", "label": "Created At", "type": "datetime", "readOnly": true },
    { "name": "updatedAt", "label": "Updated At", "type": "datetime", "readOnly": true }
  ],

  "relations": [
    { "entity": "patients", "type": "ManyToOne", "foreignKey": "patientId" },
    { "entity": "doctors", "type": "ManyToOne", "foreignKey": "doctorId" },
    { "entity": "appointments", "type": "ManyToOne", "foreignKey": "appointmentId" }
  ],

  "ui": {
    "listView": {
      "title": "Follow-up Schedule",
      "columns": ["patientId", "doctorId", "followUpDate", "purpose", "status"],
      "filters": ["doctorId", "status", "purpose"],
      "searchFields": ["patientId", "doctorId"],
      "actions": ["view", "edit", "delete"]
    },

    "formView": {
      "title": "Add / Edit Follow-up",
      "layout": [
        ["patientId", "doctorId"],
        ["followUpDate", "purpose"],
        ["notes"],
        ["feedback"],
        ["status"]
      ],
      "actions": [
        {
          "id": "saveFollowUp",
          "label": "Save Follow-up",
          "type": "submit",
          "endpoint": "/api/followups",
          "method": "POST",
          "successMessage": "Follow-up saved successfully!"
        },
        { "id": "cancel", "label": "Cancel", "type": "cancel" }
      ]
    },

    "detailView": {
      "title": "Follow-up Details",
      "sections": [
        {
          "title": "Follow-up Overview",
          "fields": ["patientId", "doctorId", "followUpDate", "purpose", "status"]
        },
        {
          "title": "Notes & Feedback",
          "fields": ["notes", "feedback"]
        },
        {
          "title": "Timestamps",
          "fields": ["createdAt", "updatedAt"]
        }
      ]
    }
  },

  "actions": [
    {
      "id": "markCompleted",
      "label": "Mark as Completed",
      "type": "action",
      "endpoint": "/api/followups/:id/status",
      "method": "PATCH",
      "body": { "status": "COMPLETED" },
      "successMessage": "Follow-up marked as completed."
    },
    {
      "id": "reschedule",
      "label": "Reschedule",
      "type": "link",
      "to": "/appointments/reschedule?followupId={{id}}"
    }
  ],

  "reasoning": {
    "businessLogic": "Follow-ups maintain continuity in patient care by ensuring scheduled reviews after diagnosis, procedures, or discharge. Doctors and receptionists manage these to improve patient outcomes.",
    "uiLogic": "The UI allows filtering by doctor, date, or status to manage upcoming visits. Actions like marking completed or rescheduling are quick, role-based, and tied to appointments."
  }
}
