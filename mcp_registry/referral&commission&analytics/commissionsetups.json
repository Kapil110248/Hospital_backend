
{
  "id": "commissionsetups",
  "title": "Commission Setup",
  "description": "Defines commission rules, percentages, and eligibility criteria for doctors, staff, or external referral partners. Supports both percentage-based and fixed commissions.",
  "route": "/commission/setup",
  "icon": "Settings2",
  "entity": "CommissionSetup",
  "version": "1.0.0",

  "permissions": {
    "view": ["Admin", "Accountant"],
    "create": ["Admin"],
    "edit": ["Admin"],
    "delete": ["Admin"]
  },

  "api": {
    "list": "/api/commissionsetups",
    "get": "/api/commissionsetups/:id",
    "create": "/api/commissionsetups",
    "update": "/api/commissionsetups/:id",
    "delete": "/api/commissionsetups/:id"
  },

  "fields": [
    {
      "name": "id",
      "label": "Setup ID",
      "type": "uuid",
      "primary": true,
      "autoGenerated": true
    },
    {
      "name": "ruleName",
      "label": "Commission Rule Name",
      "type": "string",
      "placeholder": "e.g., Doctor Consultation 10%",
      "required": true,
      "unique": true,
      "showInList": true
    },
    {
      "name": "applicableTo",
      "label": "Applicable To",
      "type": "enum",
      "options": ["DOCTOR", "NURSE", "REFERRAL_PARTNER", "LAB_TECHNICIAN", "PHARMACIST"],
      "widget": "select",
      "required": true,
      "showInList": true
    },
    {
      "name": "departmentId",
      "label": "Applicable Department",
      "type": "relation",
      "relationEntity": "departments",
      "relationField": "name",
      "showInList": true
    },
    {
      "name": "commissionType",
      "label": "Commission Type",
      "type": "enum",
      "options": ["PERCENTAGE", "FIXED"],
      "default": "PERCENTAGE",
      "widget": "radio",
      "showInList": true
    },
    {
      "name": "commissionValue",
      "label": "Commission Value",
      "type": "number",
      "placeholder": "Enter percentage or fixed amount",
      "required": true,
      "min": 0,
      "showInList": true
    },
    {
      "name": "applicableService",
      "label": "Linked Service / Source",
      "type": "enum",
      "options": ["CONSULTATION", "LAB_TEST", "PHARMACY_SALE", "ADMISSION", "SURGERY", "OTHER"],
      "widget": "select",
      "showInList": true
    },
    {
      "name": "minAmount",
      "label": "Minimum Transaction Amount",
      "type": "currency",
      "default": 0,
      "showInList": false
    },
    {
      "name": "maxAmount",
      "label": "Maximum Transaction Cap",
      "type": "currency",
      "default": null,
      "showInList": false
    },
    {
      "name": "effectiveFrom",
      "label": "Effective From",
      "type": "date",
      "required": true,
      "showInList": true
    },
    {
      "name": "effectiveTo",
      "label": "Effective To",
      "type": "date",
      "showInList": true
    },
    {
      "name": "active",
      "label": "Active Rule",
      "type": "boolean",
      "default": true,
      "widget": "toggle",
      "showInList": true
    },
    {
      "name": "createdBy",
      "label": "Created By",
      "type": "relation",
      "relationEntity": "users",
      "relationField": "email",
      "showInList": true
    },
    {
      "name": "createdAt",
      "label": "Created At",
      "type": "datetime",
      "readOnly": true,
      "showInList": true
    },
    {
      "name": "updatedAt",
      "label": "Updated At",
      "type": "datetime",
      "readOnly": true
    }
  ],

  "relations": [
    {
      "entity": "departments",
      "type": "ManyToOne",
      "foreignKey": "departmentId"
    },
    {
      "entity": "users",
      "type": "ManyToOne",
      "foreignKey": "createdBy"
    }
  ],

  "ui": {
    "listView": {
      "title": "Commission Rules Directory",
      "columns": [
        "ruleName",
        "applicableTo",
        "commissionType",
        "commissionValue",
        "applicableService",
        "effectiveFrom",
        "effectiveTo",
        "active"
      ],
      "filters": ["applicableTo", "commissionType", "active"],
      "searchFields": ["ruleName"],
      "actions": ["view", "edit", "delete"]
    },
    "formView": {
      "title": "Create / Edit Commission Rule",
      "layout": [
        ["ruleName", "applicableTo"],
        ["departmentId", "applicableService"],
        ["commissionType", "commissionValue"],
        ["minAmount", "maxAmount"],
        ["effectiveFrom", "effectiveTo"],
        ["active"]
      ],
      "actions": ["save", "cancel"]
    },
    "detailView": {
      "title": "Commission Rule Details",
      "sections": [
        {
          "title": "Rule Information",
          "fields": ["ruleName", "applicableTo", "departmentId", "applicableService"]
        },
        {
          "title": "Commission Details",
          "fields": ["commissionType", "commissionValue", "minAmount", "maxAmount"]
        },
        {
          "title": "Validity & Audit",
          "fields": ["effectiveFrom", "effectiveTo", "active", "createdBy", "createdAt", "updatedAt"]
        }
      ]
    }
  },

  "actions": [
    {
      "id": "activateRule",
      "label": "Activate Rule",
      "type": "update",
      "endpoint": "/api/commissionsetups/:id/activate",
      "method": "PUT",
      "payload": { "active": true },
      "successMessage": "Commission rule activated."
    },
    {
      "id": "deactivateRule",
      "label": "Deactivate Rule",
      "type": "update",
      "endpoint": "/api/commissionsetups/:id/deactivate",
      "method": "PUT",
      "payload": { "active": false },
      "successMessage": "Commission rule deactivated."
    }
  ],

  "reasoning": {
    "businessLogic": "Commission setup defines flexible rule configurations for staff incentives and referral earnings. It supports both fixed and percentage-based commissions across different departments and services.",
    "uiLogic": "The interface uses form-based rule creation with active toggles, validity dates, and service filters. This ensures precise control of when and how commissions apply."
  }
}
