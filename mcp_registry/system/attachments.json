{
  "id": "attachments",
  "title": "File Attachments",
  "description": "Manages all uploaded documents, reports, prescriptions, and other file attachments across the hospital system.",
  "route": "/attachments",
  "icon": "Paperclip",
  "entity": "Attachment",
  "version": "1.0.0",

  "permissions": {
    "view": ["Admin", "Doctor", "Nurse", "LabTechnician", "Pharmacist"],
    "upload": ["Admin", "Doctor", "Nurse", "Receptionist"],
    "delete": ["Admin"]
  },

  "api": {
    "list": "/api/attachments",
    "get": "/api/attachments/:id",
    "create": "/api/attachments",
    "delete": "/api/attachments/:id",
    "download": "/api/attachments/:id/download"
  },

  "fields": [
    {
      "name": "id",
      "label": "Attachment ID",
      "type": "uuid",
      "primary": true,
      "autoGenerated": true
    },
    {
      "name": "fileName",
      "label": "File Name",
      "type": "string",
      "required": true,
      "showInList": true
    },
    {
      "name": "fileType",
      "label": "File Type",
      "type": "enum",
      "options": [
        "IMAGE",
        "PDF",
        "DOC",
        "XLS",
        "CSV",
        "ZIP",
        "OTHER"
      ],
      "default": "OTHER",
      "widget": "select",
      "showInList": true
    },
    {
      "name": "fileUrl",
      "label": "File URL / Path",
      "type": "string",
      "readOnly": true,
      "showInList": false
    },
    {
      "name": "uploadedBy",
      "label": "Uploaded By",
      "type": "relation",
      "relationEntity": "users",
      "relationField": "fullName",
      "showInList": true
    },
    {
      "name": "relatedModule",
      "label": "Related Module",
      "type": "enum",
      "options": [
        "PATIENT",
        "DOCTOR",
        "NURSE",
        "LAB_RESULT",
        "PRESCRIPTION",
        "BILLING",
        "INVENTORY",
        "INSURANCE",
        "TASK"
      ],
      "widget": "select",
      "showInList": true
    },
    {
      "name": "relatedRecordId",
      "label": "Linked Record ID",
      "type": "string",
      "placeholder": "e.g., patientId or invoiceId",
      "showInList": false
    },
    {
      "name": "remarks",
      "label": "Remarks / Description",
      "type": "text",
      "placeholder": "Optional note about this file",
      "showInList": false
    },
    {
      "name": "uploadedAt",
      "label": "Uploaded At",
      "type": "datetime",
      "readOnly": true,
      "showInList": true,
      "sortable": true
    },
    {
      "name": "fileSize",
      "label": "File Size (KB)",
      "type": "number",
      "readOnly": true,
      "showInList": true
    }
  ],

  "relations": [
    { "entity": "users", "type": "ManyToOne", "foreignKey": "uploadedBy" }
  ],

  "ui": {
    "listView": {
      "title": "All Attachments",
      "columns": [
        "fileName",
        "fileType",
        "relatedModule",
        "uploadedBy",
        "fileSize",
        "uploadedAt"
      ],
      "filters": ["fileType", "relatedModule"],
      "searchFields": ["fileName", "relatedModule"],
      "actions": ["view", "download", "delete"]
    },
    "formView": {
      "title": "Upload Attachment",
      "layout": [
        ["fileName"],
        ["relatedModule", "relatedRecordId"],
        ["remarks"]
      ],
      "actions": [
        {
          "id": "uploadAttachment",
          "label": "Upload File",
          "type": "file-upload",
          "endpoint": "/api/attachments",
          "method": "POST",
          "accept": [
            "image/*",
            "application/pdf",
            "application/msword",
            "application/vnd.ms-excel",
            "application/zip"
          ],
          "successMessage": "File uploaded successfully!"
        },
        { "id": "cancel", "label": "Cancel", "type": "cancel" }
      ]
    },
    "detailView": {
      "title": "Attachment Details",
      "sections": [
        {
          "title": "File Info",
          "fields": [
            "fileName",
            "fileType",
            "fileSize",
            "relatedModule",
            "uploadedBy",
            "uploadedAt"
          ]
        },
        {
          "title": "Remarks",
          "fields": ["remarks"]
        },
        {
          "title": "Preview / Download",
          "fields": ["fileUrl"]
        }
      ]
    }
  },

  "actions": [
    {
      "id": "downloadFile",
      "label": "Download",
      "type": "action",
      "endpoint": "/api/attachments/:id/download",
      "method": "GET",
      "successMessage": "File download started."
    },
    {
      "id": "deleteAttachment",
      "label": "Delete File",
      "type": "delete",
      "endpoint": "/api/attachments/:id",
      "method": "DELETE",
      "confirmation": "Are you sure you want to delete this attachment?",
      "successMessage": "Attachment deleted successfully."
    }
  ],

  "reasoning": {
    "businessLogic": "Attachments act as a central repository for all documents in the hospital system â€” ensuring that staff, doctors, and admins can easily manage reports, invoices, and certifications. Each file is linked to its source module for quick traceability.",
    "uiLogic": "Admins can view all uploaded files, search by module, and preview or download directly. Upload permissions are role-based, ensuring only authorized personnel can add or delete files."
  }
}
